import React, { useState, useRef } from 'react'; // –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º —Ö—É–∫–∏ React –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –∏ —Å—Å—ã–ª–∫–∞–º–∏
import { View, Text, Image, TouchableOpacity, Alert, StyleSheet, ImageBackground } from 'react-native'; // –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã React Native –¥–ª—è UI
import { Video, AVPlaybackStatus } from 'expo-av'; // –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º Video –∏ —Ç–∏–ø AVPlaybackStatus –∏–∑ Expo –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –≤–∏–¥–µ–æ

// –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏–≥—Ä—ã ‚Äî –æ–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –¥–ª—è score, multiplier –∏ upgradeCost
interface GameState {
  score: number; // –¢–µ–∫—É—â–∏–µ –æ—á–∫–∏ –∏–≥—Ä–æ–∫–∞
  multiplier: number; // –ú–Ω–æ–∂–∏—Ç–µ–ª—å –∫–ª–∏–∫–∞ (—Å–∫–æ–ª—å–∫–æ –æ—á–∫–æ–≤ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –∑–∞ –∫–ª–∏–∫)
  upgradeCost: number; // –°—Ç–æ–∏–º–æ—Å—Ç—å —Å–ª–µ–¥—É—é—â–µ–≥–æ –∞–ø–≥—Ä–µ–π–¥–∞
}

// –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –∏–≥—Ä—ã ‚Äî —Å–æ–¥–µ—Ä–∂–∏—Ç –ª–æ–≥–∏–∫—É –∫–ª–∏–∫–∞ –∏ –∞–ø–≥—Ä–µ–π–¥–æ–≤
function Game() {
  // –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã —Å –Ω–∞—á–∞–ª—å–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
  const [gameState, setGameState] = useState<GameState>({
    score: 0, // –ù–∞—á–∏–Ω–∞–µ–º —Å 0 –æ—á–∫–æ–≤
    multiplier: 1, // –ú–Ω–æ–∂–∏—Ç–µ–ª—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é x1
    upgradeCost: 10, // –ü–µ—Ä–≤–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –∞–ø–≥—Ä–µ–π–¥–∞ ‚Äî 10 –æ—á–∫–æ–≤
  });

  // –§—É–Ω–∫—Ü–∏—è, –≤—ã–∑—ã–≤–∞–µ–º–∞—è –ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ ‚Äî —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –æ—á–∫–∏ –Ω–∞ –∑–Ω–∞—á–µ–Ω–∏–µ –º–Ω–æ–∂–∏—Ç–µ–ª—è
  const handleClick = () => {
    setGameState(prev => ({
      ...prev, // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø—Ä–µ–¥—ã–¥—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
      score: prev.score + prev.multiplier, // –î–æ–±–∞–≤–ª—è–µ–º –æ—á–∫–∏ —Å —É—á—ë—Ç–æ–º –º–Ω–æ–∂–∏—Ç–µ–ª—è
    }));
  };

  // –§—É–Ω–∫—Ü–∏—è –∞–ø–≥—Ä–µ–π–¥–∞ ‚Äî –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, —Ö–≤–∞—Ç–∞–µ—Ç –ª–∏ –æ—á–∫–æ–≤, –∏ –ø–æ–≤—ã—à–∞–µ—Ç –º–Ω–æ–∂–∏—Ç–µ–ª—å
  const handleUpgrade = () => {
    if (gameState.score >= gameState.upgradeCost) { // –ï—Å–ª–∏ –æ—á–∫–æ–≤ —Ö–≤–∞—Ç–∞–µ—Ç
      const newMultiplier = gameState.multiplier + 1; // –ù–æ–≤—ã–π –º–Ω–æ–∂–∏—Ç–µ–ª—å +1
      const newUpgradeCost = Math.floor(gameState.upgradeCost * 1.5); // –ù–æ–≤–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –Ω–∞ 50%
      setGameState({
        score: gameState.score - gameState.upgradeCost, // –í—ã—á–∏—Ç–∞–µ–º —Å—Ç–æ–∏–º–æ—Å—Ç—å –∏–∑ –æ—á–∫–æ–≤
        multiplier: newMultiplier, // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–æ–≤—ã–π –º–Ω–æ–∂–∏—Ç–µ–ª—å
        upgradeCost: newUpgradeCost, // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–æ–≤—É—é —Å—Ç–æ–∏–º–æ—Å—Ç—å
      });
      Alert.alert('–ê–ø–≥—Ä–µ–π–¥!', `–ú–Ω–æ–∂–∏—Ç–µ–ª—å —Ç–µ–ø–µ—Ä—å x${newMultiplier}! –ú–ì–ï –±—Ä–∞—Ç—å—è –Ω–µ –ø–æ–¥–≤–µ–¥—É—Ç!`); // –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—Ö–µ
    } else {
      Alert.alert('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –æ—á–∫–æ–≤!', '–°–æ–±–∏—Ä–∞–π –±–æ–ª—å—à–µ, –±—Ä–∞—Ç!'); // –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ, –µ—Å–ª–∏ –æ—á–∫–æ–≤ –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç
    }
  };

  // –í–æ–∑–≤—Ä–∞—â–∞–µ–º JSX –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–≥—Ä—ã
  return (
    <ImageBackground source={require('./assets/images/mge_2.png')} style={styles.gameContainer}>
      <Text style={styles.title}>–ú–ì–ï –ë—Ä–∞—Ç—å—è –ö–ª–∏–∫–µ—Ä</Text> {/* –ó–∞–≥–æ–ª–æ–≤–æ–∫ –∏–≥—Ä—ã */}
      <TouchableOpacity onPress={handleClick} accessibilityLabel="–ö–ª–∏–∫–Ω–∏, —á—Ç–æ–±—ã —Å–æ–±—Ä–∞—Ç—å –æ—á–∫–∏!">
        {/* –ö–Ω–æ–ø–∫–∞-–∫–ª–∏–∫: –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –ø–æ –∫–æ—Ç–æ—Ä–æ–º—É –º–æ–∂–Ω–æ –∫–ª–∏–∫–∞—Ç—å */}
        <Image
          source={require('./assets/images/mge_1.png')} // –ü—É—Ç—å –∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é –¥–ª—è –∫–ª–∏–∫–∞ (–≤–∞—à —Ñ–∞–π–ª)
          style={styles.clickImage}
          resizeMode="contain"
          accessibilityLabel="–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è –∫–ª–∏–∫–∞"
        />
      </TouchableOpacity>
      <Text style={styles.scoreText}>–û—á–∫–∏: {gameState.score}</Text> {/* –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–µ–∫—É—â–∏—Ö –æ—á–∫–æ–≤ */}
      <Text style={styles.multiplierText}>–ú–Ω–æ–∂–∏—Ç–µ–ª—å: x{gameState.multiplier}</Text> {/* –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –º–Ω–æ–∂–∏—Ç–µ–ª—è */}
      <TouchableOpacity style={styles.upgradeButton} onPress={handleUpgrade} accessibilityLabel="–ö–Ω–æ–ø–∫–∞ –∞–ø–≥—Ä–µ–π–¥–∞">
        {/* –ö–Ω–æ–ø–∫–∞ –∞–ø–≥—Ä–µ–π–¥–∞ */}
        <Text style={styles.upgradeText}>–ê–ø–≥—Ä–µ–π–¥ (–°—Ç–æ–∏–º–æ—Å—Ç—å: {gameState.upgradeCost})</Text>
      </TouchableOpacity>
      <Text style={styles.memeText}>¬´–ü–∞—Ü–∞–Ω—ã, –Ω–µ –∑–∞–±—ã–≤–∞–π—Ç–µ ‚Äî MGE –±—Ä–∞—Ç—å—è –≤—Å–µ–≥–¥–∞ –ø–æ–¥–¥–µ—Ä–∂–∞—Ç!¬ª üòé</Text> {/* –ú–µ–º–Ω—ã–π —Ç–µ–∫—Å—Ç */}
    </ImageBackground>
  );
}

// –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
export default function App() {
  // –°–æ—Å—Ç–æ—è–Ω–∏–µ –¥–ª—è –ø–æ–∫–∞–∑–∞ –∏–Ω—Ç—Ä–æ: true ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –≤–∏–¥–µ–æ, false ‚Äî –∏–≥—Ä—É
  const [showIntro, setShowIntro] = useState(true);
  // –°—Å—ã–ª–∫–∞ –Ω–∞ –≤–∏–¥–µ–æ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–º
  const videoRef = useRef<Video>(null);

  // –§—É–Ω–∫—Ü–∏—è, –≤—ã–∑—ã–≤–∞–µ–º–∞—è, –∫–æ–≥–¥–∞ –≤–∏–¥–µ–æ –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è ‚Äî –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç –Ω–∞ –∏–≥—Ä—É
  const onVideoEnd = () => {
    setShowIntro(false); // –°–∫—Ä—ã–≤–∞–µ–º –∏–Ω—Ç—Ä–æ, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–≥—Ä—É
  };

  // –í–æ–∑–≤—Ä–∞—â–∞–µ–º JSX: —É—Å–ª–æ–≤–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ ‚Äî –≤–∏–¥–µ–æ –∏–ª–∏ –∏–≥—Ä–∞
  return (
    <View style={styles.container}>
      {showIntro ? ( // –ï—Å–ª–∏ showIntro true, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –≤–∏–¥–µ–æ
        <Video
          ref={videoRef} // –°—Å—ã–ª–∫–∞ –Ω–∞ –≤–∏–¥–µ–æ –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è
          source={require('./assets/images/logo.mp4')} // –ü—É—Ç—å –∫ –≤–∞—à–µ–º—É –∏–Ω—Ç—Ä–æ-–≤–∏–¥–µ–æ —Å –ª–æ–≥–æ—Ç–∏–ø–æ–º –∏ –∑–≤—É–∫–æ–º
          style={styles.video} // –°—Ç–∏–ª–∏ –¥–ª—è –≤–∏–¥–µ–æ (–ø–æ–ª–Ω—ã–π —ç–∫—Ä–∞–Ω)
          resizeMode="contain" // –í–∏–¥–µ–æ –≤–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –±–µ–∑ –æ–±—Ä–µ–∑–∫–∏
          shouldPlay // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞–µ–º –≤–∏–¥–µ–æ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
          isMuted={false} // –í–∫–ª—é—á–∞–µ–º –∑–≤—É–∫ –≤–æ –≤—Ä–µ–º—è –∏–Ω—Ç—Ä–æ
          onPlaybackStatusUpdate={(status: AVPlaybackStatus) => { // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è —Å —Ç–∏–ø–∏–∑–∞—Ü–∏–µ–π
            if (status.didJustFinish) { // –ï—Å–ª–∏ –≤–∏–¥–µ–æ –∑–∞–∫–æ–Ω—á–∏–ª–æ—Å—å
              onVideoEnd(); // –í—ã–∑—ã–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é –æ–∫–æ–Ω—á–∞–Ω–∏—è
            }
          }}
        />
      ) : ( // –ï—Å–ª–∏ showIntro false, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–≥—Ä—É
        <Game />
      )}
    </View>
  );
}

// –°—Ç–∏–ª–∏ –¥–ª—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ ‚Äî –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç –≤–Ω–µ—à–Ω–∏–π –≤–∏–¥
const styles = StyleSheet.create({
  container: { // –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
    flex: 1, // –ó–∞–Ω–∏–º–∞–µ—Ç –≤–µ—Å—å —ç–∫—Ä–∞–Ω
    backgroundColor: 'black', // –ß—ë—Ä–Ω—ã–π —Ñ–æ–Ω
  },
  video: { // –°—Ç–∏–ª–∏ –¥–ª—è –≤–∏–¥–µ–æ
    flex: 1, // –ó–∞–Ω–∏–º–∞–µ—Ç –≤–µ—Å—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
    width: '100%', // –ü–æ–ª–Ω–∞—è —à–∏—Ä–∏–Ω–∞
    height: '100%',
  },
  gameContainer: { // –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –∏–≥—Ä—ã
    flex: 1, // –ó–∞–Ω–∏–º–∞–µ—Ç –≤–µ—Å—å —ç–∫—Ä–∞–Ω
    justifyContent: 'center', // –¶–µ–Ω—Ç—Ä–∏—Ä—É–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ
    alignItems: 'center', // –¶–µ–Ω—Ç—Ä–∏—Ä—É–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ
    padding: 40, // –û—Ç—Å—Ç—É–ø—ã
  },
  title: { // –°—Ç–∏–ª–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞
    fontSize: 36, // –†–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞
    fontWeight: 'bold', // –ñ–∏—Ä–Ω—ã–π
    marginBottom: 25, // –û—Ç—Å—Ç—É–ø —Å–Ω–∏–∑—É
    color: '#ff6f00', // –û—Ä–∞–Ω–∂–µ–≤—ã–π —Ü–≤–µ—Ç
    textShadowColor: '#000', // –¢–µ–Ω—å
    textShadowOffset: { width: 2, height: 2 }, // –°–º–µ—â–µ–Ω–∏–µ —Ç–µ–Ω–∏
    textShadowRadius: 4, // –†–∞–∑–º—ã—Ç–∏–µ —Ç–µ–Ω–∏
  },
  clickImage: { // –°—Ç–∏–ª–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è –∫–ª–∏–∫–∞
    width: 160, // –®–∏—Ä–∏–Ω–∞
    height: 160, // –í—ã—Å–æ—Ç–∞
    marginBottom: 25, // –û—Ç—Å—Ç—É–ø —Å–Ω–∏–∑—É
  },
  scoreText: { // –°—Ç–∏–ª–∏ —Ç–µ–∫—Å—Ç–∞ –æ—á–∫–æ–≤
    fontSize: 26, // –†–∞–∑–º–µ—Ä
    marginBottom: 8, // –û—Ç—Å—Ç—É–ø
    color: '#fff', // –ë–µ–ª—ã–π —Ü–≤–µ—Ç
    textShadowColor: '#000', // –¢–µ–Ω—å
    textShadowOffset: { width: 1, height: 1 },
    textShadowRadius: 2,
  },
  multiplierText: { // –°—Ç–∏–ª–∏ —Ç–µ–∫—Å—Ç–∞ –º–Ω–æ–∂–∏—Ç–µ–ª—è
    fontSize: 20,
    marginBottom: 20,
    color: '#ddd', // –°–≤–µ—Ç–ª–æ-—Å–µ—Ä—ã–π
    textShadowColor: '#000',
    textShadowOffset: { width: 1, height: 1 },
    textShadowRadius: 2,
  },
  upgradeButton: { // –°—Ç–∏–ª–∏ –∫–Ω–æ–ø–∫–∏ –∞–ø–≥—Ä–µ–π–¥–∞
    backgroundColor: '#ff4500', // –ö—Ä–∞—Å–Ω—ã–π —Ñ–æ–Ω
    paddingVertical: 15, // –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π –æ—Ç—Å—Ç—É–ø
    paddingHorizontal: 30, // –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–π –æ—Ç—Å—Ç—É–ø
    borderRadius: 12, // –ó–∞–∫—Ä—É–≥–ª–µ–Ω–∏–µ —É–≥–ª–æ–≤
    marginBottom: 20, // –û—Ç—Å—Ç—É–ø —Å–Ω–∏–∑—É
    shadowColor: '#ff4500', // –¢–µ–Ω—å —Ü–≤–µ—Ç–∞ –∫–Ω–æ–ø–∫–∏
    shadowOffset: { width: 0, height: 0 },
    shadowOpacity: 1, // –ü–æ–ª–Ω–∞—è –Ω–µ–ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å —Ç–µ–Ω–∏
    shadowRadius: 10, // –†–∞–∑–º—ã—Ç–∏–µ —Ç–µ–Ω–∏
  },
  upgradeText: { // –°—Ç–∏–ª–∏ —Ç–µ–∫—Å—Ç–∞ –∫–Ω–æ–ø–∫–∏
    color: 'white', // –ë–µ–ª—ã–π —Ü–≤–µ—Ç
    fontSize: 20, // –†–∞–∑–º–µ—Ä
    fontWeight: '700', // –ñ–∏—Ä–Ω—ã–π
  },
  memeText: { // –°—Ç–∏–ª–∏ –º–µ–º–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
    fontSize: 16, // –†–∞–∑–º–µ—Ä
    color: '#ccc', // –°–µ—Ä—ã–π —Ü–≤–µ—Ç
    fontStyle: 'italic', // –ö—É—Ä—Å–∏–≤
    maxWidth: 400, // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —à–∏—Ä–∏–Ω–∞
    textAlign: 'center', // –¶–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞
  },
});
